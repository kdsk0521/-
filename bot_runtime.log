2026-01-04 20:37:39,502 [WARNING] PyNaCl is not installed, voice will NOT be supported
2026-01-04 20:37:39,508 [INFO] logging in using static token
2026-01-04 20:37:40,836 [INFO] Shard ID None has connected to Gateway (Session ID: f66bc52790cf2e602d612f17ca1cac0a).
2026-01-04 20:37:42,861 [INFO] 로그인 성공: 파티 챗#6510
2026-01-04 20:39:01,687 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 20:39:12,409 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 20:39:12,417 [ERROR] Error: create_risu_style_session() takes 3 positional arguments but 4 were given
2026-01-04 20:39:13,008 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 20:39:27,588 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 20:39:27,596 [ERROR] Error: create_risu_style_session() takes 3 positional arguments but 4 were given
2026-01-04 20:39:27,933 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 20:39:42,626 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 20:39:42,638 [ERROR] Error: create_risu_style_session() takes 3 positional arguments but 4 were given
2026-01-04 20:39:43,258 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 20:40:03,840 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 20:41:07,389 [ERROR] Error: 'TextChannel' object has no attribute 'bot'
2026-01-04 21:50:06,560 [WARNING] PyNaCl is not installed, voice will NOT be supported
2026-01-04 21:50:06,563 [INFO] logging in using static token
2026-01-04 21:50:08,444 [INFO] Shard ID None has connected to Gateway (Session ID: 7c74d46dc1db194756dfed0f17f5994e).
2026-01-04 21:50:10,501 [INFO] 로그인 성공: 파티 챗#6510
2026-01-04 21:52:16,707 [INFO] Shard ID None has successfully RESUMED session 7c74d46dc1db194756dfed0f17f5994e.
2026-01-04 21:52:28,365 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 21:52:51,767 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 21:55:32,534 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 21:55:53,386 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 513, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 360, in on_message
    nvc_result = await memory_system.analyze_context_nvc(client_genai, MODEL_ID, recent_history_text, lore_text, rule_text)
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    response = client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 21:56:03,397 [WARNING] Shard ID None heartbeat blocked for more than 20 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 513, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 360, in on_message
    nvc_result = await memory_system.analyze_context_nvc(client_genai, MODEL_ID, recent_history_text, lore_text, rule_text)
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    response = client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 21:56:05,197 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 21:56:05,210 [ERROR] Error: create_risu_style_session() takes 3 positional arguments but 4 were given
2026-01-04 21:56:05,829 [INFO] Shard ID None has successfully RESUMED session 7c74d46dc1db194756dfed0f17f5994e.
2026-01-04 21:58:18,612 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 21:58:35,689 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 21:58:35,698 [ERROR] Error: create_risu_style_session() takes 3 positional arguments but 4 were given
2026-01-04 21:59:04,521 [WARNING] PyNaCl is not installed, voice will NOT be supported
2026-01-04 21:59:04,525 [INFO] logging in using static token
2026-01-04 21:59:06,616 [INFO] Shard ID None has connected to Gateway (Session ID: a257ab5c9be75d6631ac5e54405f01c9).
2026-01-04 21:59:08,631 [INFO] 로그인 성공: 파티 챗#6510
2026-01-04 21:59:33,395 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 21:59:52,115 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 21:59:52,125 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 21:59:57,616 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 513, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 501, in on_message
    response = await persona.generate_response_with_retry(client_genai, session, full_prompt)
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 153, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\chats.py", line 254, in send_message
    response = self._modules.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:00:07,633 [WARNING] Shard ID None heartbeat blocked for more than 20 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 513, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 501, in on_message
    response = await persona.generate_response_with_retry(client_genai, session, full_prompt)
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 153, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\chats.py", line 254, in send_message
    response = self._modules.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:00:15,094 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:00:15,121 [ERROR] Attempting a reconnect in 1.44s
Traceback (most recent call last):
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 727, in connect
    await self.ws.poll_event()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 635, in poll_event
    await self.received_message(msg.data)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 540, in received_message
    await self.send_as_json(beat)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 671, in send_as_json
    await self.send(utils._to_json(data))
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 667, in send
    await self.socket.send_str(data)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\client_ws.py", line 245, in send_str
    await self._writer.send_frame(
        data.encode("utf-8"), WSMsgType.TEXT, compress=compress
    )
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\_websocket\writer.py", line 83, in send_frame
    self._write_websocket_frame(message, opcode, 0)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\_websocket\writer.py", line 151, in _write_websocket_frame
    raise ClientConnectionResetError("Cannot write to closing transport")
aiohttp.client_exceptions.ClientConnectionResetError: Cannot write to closing transport
2026-01-04 22:00:17,202 [INFO] Shard ID None has successfully RESUMED session a257ab5c9be75d6631ac5e54405f01c9.
2026-01-04 22:01:48,709 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:02:18,188 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:02:18,201 [ERROR] Error: 'Chat' object has no attribute 'history'
2026-01-04 22:05:10,618 [WARNING] PyNaCl is not installed, voice will NOT be supported
2026-01-04 22:05:10,622 [INFO] logging in using static token
2026-01-04 22:05:12,069 [INFO] Shard ID None has connected to Gateway (Session ID: 25731acacab9477e1ff0e991ef57b4e4).
2026-01-04 22:05:14,089 [INFO] 로그인 성공: 파티 챗#6510
2026-01-04 22:05:32,006 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:05:55,653 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:05:56,124 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:06:15,567 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:12:37,522 [WARNING] PyNaCl is not installed, voice will NOT be supported
2026-01-04 22:12:37,526 [INFO] logging in using static token
2026-01-04 22:12:38,814 [INFO] Shard ID None has connected to Gateway (Session ID: d59c73d6c5b858af03095341ccc5924b).
2026-01-04 22:12:40,826 [INFO] 로그인 성공: 파티 챗#6510
2026-01-04 22:15:11,746 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:15:32,839 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:15:32,849 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:15:33,561 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 507, in on_message
    response = await persona.generate_response_with_retry(client_genai, session, full_prompt)
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 210, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 140, in send_message
    response = self.client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:15:43,574 [WARNING] Shard ID None heartbeat blocked for more than 20 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 507, in on_message
    response = await persona.generate_response_with_retry(client_genai, session, full_prompt)
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 210, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 140, in send_message
    response = self.client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:15:44,956 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:15:45,414 [INFO] Shard ID None has successfully RESUMED session d59c73d6c5b858af03095341ccc5924b.
2026-01-04 22:18:08,720 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:18:27,751 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:18:27,770 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:18:40,286 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
    client_discord.run(DISCORD_TOKEN)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 507, in on_message
    response = await persona.generate_response_with_retry(client_genai, session, full_prompt)
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 210, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 140, in send_message
    response = self.client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:18:48,520 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:18:48,532 [ERROR] Attempting a reconnect in 1.37s
Traceback (most recent call last):
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 727, in connect
    await self.ws.poll_event()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 635, in poll_event
    await self.received_message(msg.data)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 540, in received_message
    await self.send_as_json(beat)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 671, in send_as_json
    await self.send(utils._to_json(data))
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 667, in send
    await self.socket.send_str(data)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\client_ws.py", line 245, in send_str
    await self._writer.send_frame(
        data.encode("utf-8"), WSMsgType.TEXT, compress=compress
    )
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\_websocket\writer.py", line 83, in send_frame
    self._write_websocket_frame(message, opcode, 0)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\_websocket\writer.py", line 151, in _write_websocket_frame
    raise ClientConnectionResetError("Cannot write to closing transport")
aiohttp.client_exceptions.ClientConnectionResetError: Cannot write to closing transport
2026-01-04 22:18:50,365 [INFO] Shard ID None has successfully RESUMED session d59c73d6c5b858af03095341ccc5924b.
2026-01-04 22:25:13,676 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:25:30,629 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:25:31,051 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:25:49,359 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:30:32,663 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:30:48,301 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
    session = persona.create_risu_style_session(client_genai, MODEL_ID, lore_text, rule_text)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 366, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    response = client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:30:49,736 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:30:50,187 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:31:13,827 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:35:09,940 [INFO] Shard ID None has successfully RESUMED session d59c73d6c5b858af03095341ccc5924b.
2026-01-04 22:42:36,155 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:42:53,775 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 366, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    return parse_nvc_result(response.text)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:43:03,796 [WARNING] Shard ID None heartbeat blocked for more than 20 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 366, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    return parse_nvc_result(response.text)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:43:07,889 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:43:07,899 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:43:13,803 [WARNING] Shard ID None heartbeat blocked for more than 30 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 507, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 210, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 140, in send_message
    response = self.client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:43:23,819 [WARNING] Shard ID None heartbeat blocked for more than 40 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 507, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 210, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 140, in send_message
    response = self.client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:43:25,703 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:43:25,716 [ERROR] Attempting a reconnect in 2.56s
Traceback (most recent call last):
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 727, in connect
    await self.ws.poll_event()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 635, in poll_event
    await self.received_message(msg.data)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 540, in received_message
    await self.send_as_json(beat)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 671, in send_as_json
    await self.send(utils._to_json(data))
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\gateway.py", line 667, in send
    await self.socket.send_str(data)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\client_ws.py", line 245, in send_str
    await self._writer.send_frame(
        data.encode("utf-8"), WSMsgType.TEXT, compress=compress
    )
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\_websocket\writer.py", line 83, in send_frame
    self._write_websocket_frame(message, opcode, 0)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\aiohttp\_websocket\writer.py", line 151, in _write_websocket_frame
    raise ClientConnectionResetError("Cannot write to closing transport")
aiohttp.client_exceptions.ClientConnectionResetError: Cannot write to closing transport
2026-01-04 22:43:28,757 [INFO] Shard ID None has successfully RESUMED session d59c73d6c5b858af03095341ccc5924b.
2026-01-04 22:48:02,612 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:48:27,394 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 366, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    return parse_nvc_result(response.text)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:48:29,357 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:48:29,366 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:48:37,556 [WARNING] Shard ID None heartbeat blocked for more than 20 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 507, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 210, in generate_response_with_retry
    response = chat_session.send_message(
  File "C:\Users\kdsk\Desktop\aiaichat\persona.py", line 140, in send_message
    response = self.client.models.generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:48:40,972 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:48:41,569 [INFO] Shard ID None has successfully RESUMED session d59c73d6c5b858af03095341ccc5924b.
2026-01-04 22:51:23,276 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:51:36,438 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 366, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    return parse_nvc_result(response.text)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:51:46,454 [WARNING] Shard ID None heartbeat blocked for more than 20 seconds.
Loop thread traceback (most recent call last):
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 523, in <module>
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 929, in run
    asyncio.run(runner())
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 204, in run
    return runner.run(main)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\runners.py", line 127, in run
    return self._loop.run_until_complete(task)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 706, in run_until_complete
    self.run_forever()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 677, in run_forever
    self._run_once()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\base_events.py", line 2046, in _run_once
    handle._run()
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\asyncio\events.py", line 94, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\discord\client.py", line 504, in _run_event
    await coro(*args, **kwargs)
  File "C:\Users\kdsk\Desktop\aiaichat\main.py", line 366, in on_message
  File "C:\Users\kdsk\Desktop\aiaichat\memory_system.py", line 46, in analyze_context_nvc
    return parse_nvc_result(response.text)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 5203, in generate_content
    response = self._generate_content(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\models.py", line 3985, in _generate_content
    response = self._api_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\google\genai\_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpx\_transports\default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\connection.py", line 103, in handle_request
    return self._connection.handle_request(request)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 106, in handle_request
    ) = self._receive_response_headers(**kwargs)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 177, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_sync\http11.py", line 217, in _receive_event
    data = self._network_stream.read(
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\site-packages\httpcore\_backends\sync.py", line 128, in read
    return self._sock.recv(max_bytes)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1285, in recv
    return self.read(buflen)
  File "C:\Users\kdsk\AppData\Local\Programs\Python\Python314\Lib\ssl.py", line 1140, in read
    return self._sslobj.read(len)

2026-01-04 22:51:55,474 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:51:55,952 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:52:24,128 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:52:24,138 [WARNING] Can't keep up, shard ID None websocket is 28.4s behind.
2026-01-04 22:52:24,140 [INFO] Shard ID None has successfully RESUMED session d59c73d6c5b858af03095341ccc5924b.
2026-01-04 22:55:34,173 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:56:07,766 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
2026-01-04 22:56:08,158 [INFO] AFC is enabled with max remote calls: 10.
2026-01-04 22:56:53,509 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-3-pro-preview:generateContent "HTTP/1.1 200 OK"
